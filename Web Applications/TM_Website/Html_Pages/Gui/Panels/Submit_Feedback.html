<!DOCTYPE HTML>
<html ng-app>
    
    <head>
        <title>TeamMentor 3.3</title>		
        <link   type="text/css" href="/aspx_Pages/scriptCombiner.ashx?s=HomePage_CSS&ct=css" rel="stylesheet" />
        <link   type="text/css" href="/Javascript/bootstrap/2.3.1/css/bootstrap-responsive.css" rel="stylesheet" />
        <link   type="text/css" href="/Javascript/bootstrap/2.3.1/css/bootstrap.min.css" rel="stylesheet" />        
        <script type="text/javascript" src="/Javascript/angularJS/1.0.5/angular.min.js"></script>                 <script type="text/javascript" src="/aspx_Pages/scriptCombiner.ashx?s=ArticleView_JS&_dontMinify=true"></script>
    </head>

    <body>
        <style  type="text/css">
            .css-form input.ng-invalid.ng-dirty { background-color: #FA787E; }
            .css-form input.ng-valid.ng-dirty { background-color: #78FA89; }
        </style>	                        
        <script type="text/javascript">
            function SubmitFeedbackController($scope, $timeout, $http) 
            {
                scope = $scope;
                $scope.master = {};

                $scope.email =
                {
                    subject: 'TeamMentor Feedback',
                    message: ''
                };

                $scope.reset = function () 
                {
                    $scope.result = '';
                };

                $scope.send = function (email) {
                    $scope.result = "Sending email...";
                    $http.put('/rest/SendFeedback/',
                        {
                            "To": email.to,
                            "From": email.from,
                            "Subject": email.subject,
                            "Message": email.message
                        })
                        .success(function (data, status) {
                            $scope.result = 'Feedback submitted. Thank you.';
                            $('#guidanceItemFeedbackResult').height(260);
                                                         })

                        .error(function (data, status) {
                            $scope.result = 'Failed to send feedback';
                                                       });
                    $("#guidanceItemFeedbackControl").css("display", "none");
                                               };
            }
        </script>
        <div id="SubmitFeedbackToSI" style="font-size:13px">

            <div ng-controller="SubmitFeedbackController">
                
                <form name="myForm" class="css-form form-horizontal" ng-submit="send(email)">
                    <div class="AppFeedback" id="guidanceItemFeedbackControl">
                        <div><span class="CommentBodyBox" style="vertical-align: top">Comment:</span> <textarea id="guidanceItemFeedback" rows="8" cols="80" ng-model="email.message" required></textarea></div>
                        <div><span class="CommentBodyBox">Reply To:</span> <input id="submitFeedbackReplyTo" type="email" ng-model="email.from" size="58" required/></div>
                        <div>
                            <button class="IVButton" id="submitFeedback" type="submit">Send</button>
                        <!--                            
                            I could not make this button work :(
-->
                            <button class="IVButton" id="cancelFeedback" type="button">Cancel</button>
                        </div>
                    </div>		
                </form>

                <div style="text-align: center" >
                    <div id="guidanceItemFeedbackResult" ng-model="result">{{result}}</div>
                    <div>A <a href="http://www.securityinnovation.com" target="_blank">Security Innovation</a> eLearning Product</div>
                </div>
            
            </div>

        </div>    
    </body>
    <script type="text/javascript">
        $("#cancelFeedback")
            .bind('click',
                function () {
                    //Not sure which object to call closeDialog on!
                    $(this.parent().parent().parent()).closeDialog();
                });
    </script>
</html>

