<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
 
<head> 
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" /> 
	<title>TeamMentor | Login</title> 
	
	<link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/reset.css"      type="text/css" media="screen" title="no title" />
	<link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/text.css"       type="text/css" media="screen" title="no title" />
	<link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/buttons.css"    type="text/css" media="screen" title="no title" />
	<link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/login.css"      type="text/css" media="screen" title="no title" />
	<link rel="stylesheet" href="/css/ThemeForest_ReadyMade/css/forms.css"      type="text/css" media="screen" title="no title" />

    <script src="/aspx_Pages/scriptCombiner.ashx?s=WebServices_JS" type="text/javascript"></script>

    <script type="text/javascript">
	
        function loginResponse(loginId)
        {									
            if(loginId =='00000000-0000-0000-0000-000000000000') {
                $("#loginFailed").html('Login failed');
                $("#loginFailed").fadeIn();
                $("#loginButton").html('Login');
            }
            else
            {	
                if (document.referrer != "" &&                                      // it's valid
                    document.referrer != document.location &&                       // not the current page
                    document.referrer.split("/").indexOf("passwordReset") == -1)    // not back into the password Reset page
                {
                    document.location = document.referrer;
                }
                else			
                    document.location = "/Login_OK" + document.location.search;
            }
        }

        var onSubmit = function () {
            alert('??');
            return false;
        };

        $(function () {
            //css fixes
            $("#loginFailed").hide()
                .absolute()
                .left(90)
                .top(67);
            $("h1").css('background-image', '/Images/HeaderImage.jpg');
            $("#SI_Logo").width(250);
            $(".form").height(209);
            $("#passwordForgotLink").relative().top(7);

            //set the click event for the login button 
            //$("#loginButton").click(onSubmit);

            $.validator.messages.required = '';

            $("#loginForm").validate({
                submitHandler: function (form) {
                    $("#loginFailed").fadeOut();
                    $("#loginButton").html('Logging in');
                    var username = $("#username").attr('value');
                    var password = $("#password").attr('value');
                    //console.log("login in with: " + username + " : " + password);
                    TM.WebServices.WS_Users.login(username, password, loginResponse);
                    $("#passwordForgotLink").relative().top(7).css("", "");
                    return;
                },

                invalidHandler: function (event, validator) {
                    // 'this' refers to the form
                    var errors = validator.numberOfInvalids();
                    if (errors) {
                        var username = $("#username").attr('value');
                        var password = $("#password").attr('value');
                        var message = '';
                        if (username == '' && password == '')
                        {
                            message = '<span>Please enter username and password</span>';
                        }
                        else if (username == '')
                        {
                            message = '<span>Please enter username</span>';
                        }
                        else if (password == '') 
                        {
                            message = '<span>Please enter password</span>';
                        }
                        $("#loginFailed").html(message);
                        $("#loginFailed").show();
                    } else {
                        $("#loginFailed").hide();
                    }
                }
            });

        });
    </script>

</head> 
 
<body> 

<div id="login">	
	<div id="login_panel">		
	<img src='/Images/HeaderImage.jpg' id='SI_Logo' alt="Security Innovation: Team Mentor"/>	
		<form class="form" id="loginForm" method="POST" >					
			<div class="login_fields">
				<div class="field">
					<label for="username">Username</label>					
					<input type="text" name="username" value="" id="username" tabindex="1" placeholder="tmUser" class="required login_text" />		
					<div class="error" id="loginFailed"><span>Login Failed</span></div>
				</div>
				
				
				<div class="field">
					<label for="password">Password</label>
					<input type="password" name="password" value="" id="password" tabindex="2" placeholder="******" class="required login_text" />			
				</div>
			</div> <!-- .login_fields -->
			
			<div class="login_actions">				
			    <input type="submit" id="loginButton" class="btn primary" tabindex="3" value="Login" />
                &nbsp;&nbsp;<a href="/passwordForgot" id="passwordForgotLink" style="float:right">Forgot your password?</a>
			</div>
			
		</form>
	</div> <!-- #login_panel -->		
</div> <!-- #login -->

</body> 
 
</html> 